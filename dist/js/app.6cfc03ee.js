(function(){"use strict";var e={4043:function(e,t,a){var s=a(6369),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[],o={},l=o,n=a(1001),c=(0,n.Z)(l,r,i,!1,null,null,null),d=c.exports,u=a(2631),m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-con"},[t("div",{staticClass:"login-box"},[t("h1",[e._v("欢迎登陆")]),t("div",{staticClass:"box"},[t("el-form",{ref:"loginformref",staticClass:"form-login",attrs:{"label-width":"0px",model:e.loginform,rules:e.rules}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{"prefix-icon":"iconfont icon-user"},model:{value:e.loginform.username,callback:function(t){e.$set(e.loginform,"username",t)},expression:"loginform.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{"prefix-icon":"iconfont icon-3702mima",type:"password",prop:"password"},model:{value:e.loginform.password,callback:function(t){e.$set(e.loginform,"password",t)},expression:"loginform.password"}})],1),t("el-form-item",{staticClass:"btns"},[t("el-button",{attrs:{type:"primary"},on:{click:e.loginbtn}},[e._v("登录")]),t("el-button",{attrs:{type:"info"},on:{click:e.resetform}},[e._v("重置")])],1)],1)],1)])])},p=[],g=(a(7658),{data(){return{loginform:{username:"admin",password:"123456"},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:12,message:"长度在 6 到 12 个字符",trigger:"blur"}]}}},methods:{resetform(){this.$refs.loginformref.resetFields()},loginbtn(){this.$refs.loginformref.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("login",this.loginform);if(200!==t.meta.status)return this.$message.error("用户名或密码错误");window.sessionStorage.setItem("token",t.data.token),this.$router.push("/home"),this.$message.success(`登录成功,欢迎您${this.loginform.username}`)}))}}}),h=g,f=(0,n.Z)(h,m,p,!1,null,"fc5909dc",null),b=f.exports,v=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"home-container"},[t("el-header",[t("h2",[e._v("后台管理系统")]),t("el-button",{staticClass:"exitbtn",attrs:{type:"primary"},on:{click:e.exit}},[e._v("退出登录")])],1),t("el-container",[t("el-aside",{attrs:{width:e.iscollapse?"64px":"200px"}},[t("div",{staticClass:"toggle-btn",on:{click:e.close}},[e._v("|||")]),t("el-menu",{attrs:{"background-color":"#333744","text-color":"#fff","active-text-color":"#409eff","unique-opened":"",collapse:e.iscollapse,"collapse-transition":!1,router:!0,"default-active":e.activePath}},e._l(e.menulist,(function(a){return t("el-submenu",{key:a.id,attrs:{index:a.id+""}},[t("template",{slot:"title"},[t("i",{class:e.iconObj[a.id]}),t("span",[e._v(e._s(a.authName))])]),e._l(a.children,(function(a){return t("el-menu-item",{key:a.id,attrs:{index:"/"+a.path},on:{click:function(t){return e.saveNav("/"+a.path)}}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-menu"}),t("span",[e._v(e._s(a.authName))])])],2)}))],2)})),1)],1),t("el-main",[t("router-view")],1)],1)],1)},_=[],y={data(){return{menulist:[],iconObj:{125:"iconfont icon-user",103:"iconfont icon-tijikongjian",101:"iconfont icon-shangpin",102:"iconfont icon-danju",145:"iconfont icon-baobiao"},iscollapse:!1,activePath:""}},created(){this.getMenuList(),this.activePath=window.sessionStorage.getItem("activePath")},methods:{exit(){window.sessionStorage.clear(),this.$router.push("/login")},async getMenuList(){const{data:e}=await this.$http.get("menus");if(200!==e.meta.status)return this.$message.error(e.meta.msg);this.menulist=e.data},close(){this.iscollapse=!this.iscollapse},saveNav(e){window.sessionStorage.setItem("activePath",e),this.activePath=e},userpage(){this.$router.push("/myself")}}},w=y,$=(0,n.Z)(w,v,_,!1,null,"7bac5ddf",null),k=$.exports,x=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wel"},[t("h1",[e._v("欢迎使用后台管理系统")]),t("h1",[e._v(e._s(e.newTime))]),t("el-calendar",{model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)},F=[];const V=["天","一","二","三","四","五","六"];var C,z=new Date,q={name:"app",data(){return{year:z.getFullYear(),month:z.getMonth()+1,date:z.getDate(),day:V[z.getDay()-1],time:z.toTimeString().substring(0,8),value:new Date}},created(){C=setInterval((()=>{let e=new Date;this.year=e.getFullYear(),this.month=e.getMonth()+1,this.date=e.getDate(),this.day=V[e.getDay()],this.time=e.toTimeString().substring(0,8)}),1e3)},computed:{newTime:function(){return this.year+"年"+this.month+"月"+this.date+"日 星期"+this.day+" "+this.time}},beforeDestroy(){clearInterval(C)}},R=q,S=(0,n.Z)(R,x,F,!1,null,"095626dc",null),I=S.exports,N=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("用户管理")]),t("el-breadcrumb-item",[e._v("用户列表")])],1),t("el-card",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getUserList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加用户")])],1)],1),t("el-table",{attrs:{data:e.userlist,stripe:""}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"姓名",prop:"username"}}),t("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),t("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),t("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),t("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{on:{change:function(t){return e.userStateChanged(a.row)}},model:{value:a.row.mg_state,callback:function(t){e.$set(a.row,"mg_state",t)},expression:"scope.row.mg_state"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",size:"mini"},on:{click:function(t){return e.showdialog(a.row.id)}}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(t){return e.delteuserById(a.row.id)}}}),t("el-tooltip",{attrs:{effect:"dark",content:"分配角色",placement:"top",enterable:!1}},[t("el-button",{attrs:{type:"warning",icon:"el-icon-setting",circle:"",size:"mini"},on:{click:function(t){return e.setRole(a.row)}}})],1)]}}])})],1),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[2,5,10],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"添加用户",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.dialogclose}},[t("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormrules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),t("el-form-item",{attrs:{label:"手机",prop:"phone"}},[t("el-input",{model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.adduser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"修改用户",visible:e.editdialogVisible,width:"50%"},on:{"update:visible":function(t){e.editdialogVisible=t},close:e.editdialogclose}},[t("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[t("el-input",{model:{value:e.editForm.mobile,callback:function(t){e.$set(e.editForm,"mobile",t)},expression:"editForm.mobile"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.changeuser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"分配角色",visible:e.setroledialogVisible,width:"50%"},on:{"update:visible":function(t){e.setroledialogVisible=t},close:e.setdialogclosed}},[t("div",[t("p",[e._v("当前用户："+e._s(e.userinfo.username))]),t("p",[e._v("当前角色："+e._s(e.userinfo.role_name))]),t("p",[e._v("分配新角色： "),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectroleid,callback:function(t){e.selectroleid=t},expression:"selectroleid"}},e._l(e.roleslist,(function(e){return t("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.setroledialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveroleinfo}},[e._v("确 定")])],1)])],1)},j=[],T={data(){var e=(e,t,a)=>{const s=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(s.test(t))return a();a(new Error("请输入合法的邮箱"))},t=(e,t,a)=>{const s=/^1(3\d|4[5-8]|5[0-35-9]|6[567]|7[01345-8]|8\d|9[025-9])\d{8}$/;if(s.test(t))return a();a(new Error("请输入正确的手机号"))};return{roleslist:[],selectroleid:"",userinfo:{},setroledialogVisible:!1,queryInfo:{query:"",pagenum:1,pagesize:2},userlist:[],total:0,dialogVisible:!1,editdialogVisible:!1,addForm:{username:"",password:"",email:"",phone:""},editForm:{},editFormRules:{email:[{required:!0,message:"请输入新邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入新手机号",trigger:"blur"},{validator:t,trigger:"blur"}]},addFormrules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created(){this.getUserList()},methods:{async getUserList(){const{data:e}=await this.$http.get("users",{params:this.queryInfo});if(200!==e.meta.status)return this.$message.error("获取失败");this.userlist=e.data.users,this.total=e.data.total},handleSizeChange(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getUserList()},async userStateChanged(e){const{data:t}=await this.$http.put(`users/${e.id}/state/${e.mg_state}`);if(200!==t.meta.status)return e.mg_state=!e.mg_state,this.$message.error("更新状态失败！");this.$message.success("更新状态成功！")},dialogclose(){this.$refs.addFormRef.resetFields()},adduser(){this.$refs.addFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("users",this.addForm);if(201!==t.meta.status)return this.$message.error("添加用户失败");this.$message.success("添加用户成功"),this.dialogVisible=!1,this.getUserList()}))},async showdialog(e){const{data:t}=await this.$http.get("users/"+e);if(200!==t.meta.status)return this.$message.error("查询用户失败");this.editForm=t.data,this.editdialogVisible=!0},editdialogclose(){this.$refs.editFormRef.resetFields()},changeuser(){this.$refs.editFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put("users/"+this.editForm.id,{email:this.editForm.email,mobile:this.editForm.mobile});if(200!==t.meta.status)return this.$message.error("修改用户失败");this.editdialogVisible=!1,this.getUserList(),this.$message.success("更新成功")}))},async delteuserById(e){const t=await this.$confirm("此操作将删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消操作");const{data:a}=await this.$http.delete("users/"+e);if(200!==a.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getUserList()},async setRole(e){this.userinfo=e;const{data:t}=await this.$http.get("roles");if(200!==t.meta.status)return this.$message.error("获取数据失败");this.roleslist=t.data,this.setroledialogVisible=!0},async saveroleinfo(){if(!this.selectroleid)return this.$message.error("请选择分配的角色");const{data:e}=await this.$http.put(`users/${this.userinfo.id}/role`,{rid:this.selectroleid});if(200!==e.meta.status)return this.$message.error("修改失败");this.$message.success("修改成功"),this.getUserList(),this.setroledialogVisible=!1},setdialogclosed(){this.selectroleid="",this.userinfo={}}}},D=T,P=(0,n.Z)(D,N,j,!1,null,"70dd0700",null),O=P.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("权限管理")]),t("el-breadcrumb-item",[e._v("权限列表")])],1),t("el-card",[t("el-table",{attrs:{data:e.rightsList,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"权限名称",prop:"authName"}}),t("el-table-column",{attrs:{label:"路径",prop:"path"}}),t("el-table-column",{attrs:{label:"权限等级",prop:"level"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"===a.row.level?t("el-tag",[e._v("一级")]):"1"===a.row.level?t("el-tag",{attrs:{type:"success"}},[e._v("二级")]):t("el-tag",{attrs:{type:"warning"}},[e._v("三级")])]}}])})],1)],1),t("a",{staticClass:"gotop",attrs:{href:"#top",target:"_self"}},[e._v("返回顶部")])],1)},Z=[],B={data(){return{rightsList:[]}},created(){this.getRightsList()},methods:{async getRightsList(){const{data:e}=await this.$http.get("rights/list");if(200!==e.meta.status)return this.$message.error("获取失败");this.rightsList=e.data}}},E=B,U=(0,n.Z)(E,L,Z,!1,null,"67ef7f06",null),K=U.exports,M=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("权限管理")]),t("el-breadcrumb-item",[e._v("角色列表")])],1),t("el-card",[t("el-row",[t("el-col",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addrolesdialogVisible=!0}}},[e._v("添加角色")])],1)],1),t("el-table",{attrs:{data:e.rolelist,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row.children,(function(s,r){return t("el-row",{key:s.id,staticClass:"firstrow",class:["bdbottom",0===r?"":"bdtop"]},[t("el-col",{attrs:{span:5}},[t("el-tag",{attrs:{closable:""},on:{close:function(t){return e.removetag(a.row,s.id)}}},[e._v(e._s(s.authName))]),t("i",{staticClass:"el-icon-caret-right"})],1),t("el-col",{attrs:{span:19}},e._l(s.children,(function(s){return t("el-row",{key:s.id,staticClass:"firstrow"},[t("el-col",{attrs:{span:6}},[t("el-tag",{attrs:{type:"success",closable:""},on:{close:function(t){return e.removetag(a.row,s.id)}}},[e._v(e._s(s.authName))]),t("i",{staticClass:"el-icon-caret-right"})],1),t("el-col",{attrs:{span:18}},e._l(s.children,(function(s){return t("el-tag",{key:s.id,attrs:{type:"warning",closable:""},on:{close:function(t){return e.removetag(a.row,s.id)}}},[e._v(e._s(s.authName))])})),1)],1)})),1)],1)}))}}])}),t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),t("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),t("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.changerolesdialog(a.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.delroles(a.row.id)}}},[e._v("删除")]),t("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(t){return e.showsetdialog(a.row)}}},[e._v("分配权限")])]}}])})],1)],1),t("el-dialog",{attrs:{title:"分配权限",visible:e.setdialogVisible,width:"50%"},on:{"update:visible":function(t){e.setdialogVisible=t},close:e.closesetdialogVisible}},[t("el-tree",{ref:"treeRef",attrs:{data:e.rightslist,props:e.treeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defKeys}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.setdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.allotRights}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加用户",visible:e.addrolesdialogVisible,width:"50%"},on:{"update:visible":function(t){e.addrolesdialogVisible=t},close:e.rolesdialogclose}},[t("el-form",{ref:"addRolesRef",attrs:{model:e.addroles,rules:e.addRolesrules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"名称",prop:"roleName"}},[t("el-input",{model:{value:e.addroles.roleName,callback:function(t){e.$set(e.addroles,"roleName",t)},expression:"addroles.roleName"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"roleDesc"}},[t("el-input",{model:{value:e.addroles.roleDesc,callback:function(t){e.$set(e.addroles,"roleDesc",t)},expression:"addroles.roleDesc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addrolesdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addrole}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑用户",visible:e.changerolesdialogVisible,width:"50%"},on:{"update:visible":function(t){e.changerolesdialogVisible=t},close:e.changedialogclose}},[t("el-form",{ref:"changeRolesRef",attrs:{model:e.changeRoles,rules:e.changeRolesrules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"名称",prop:"roleName"}},[t("el-input",{model:{value:e.changeRoles.roleName,callback:function(t){e.$set(e.changeRoles,"roleName",t)},expression:"changeRoles.roleName"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"roleDesc"}},[t("el-input",{model:{value:e.changeRoles.roleDesc,callback:function(t){e.$set(e.changeRoles,"roleDesc",t)},expression:"changeRoles.roleDesc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.changerolesdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.changerole}},[e._v("确 定")])],1)],1)],1)},A=[],Y={data(){return{roleId:"",addroles:{roleName:"",roleDesc:""},changeRoles:{},rolelist:[],setdialogVisible:!1,addrolesdialogVisible:!1,changerolesdialogVisible:!1,rightslist:[],treeProps:{label:"authName",children:"children"},defKeys:[],addRolesrules:{roleName:[{required:!0,message:"请输入角色",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},changeRolesrules:{roleName:[{required:!0,message:"请输入角色",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]}}},created(){this.getrolrlist()},methods:{async getrolrlist(){const{data:e}=await this.$http.get("roles");if(200!==e.meta.status)return this.$message.error("获取失败");this.rolelist=e.data},async removetag(e,t){const a=await this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==a)return this.$message.info("已取消删除");const{data:s}=await this.$http.delete(`roles/${e.id}/rights/${t}`);if(200!==s.meta.status)return this.$message.error("删除失败");e.children=s.data,this.$message({message:"删除成功",type:"success"})},async showsetdialog(e){this.roleId=e.id;const{data:t}=await this.$http.get("rights/tree");if(200!==t.meta.status)return this.$message.error("获取失败");this.rightslist=t.data,this.getKeys(e,this.defKeys),this.setdialogVisible=!0},getKeys(e,t){if(!e.children)return t.push(e.id);e.children.forEach((e=>this.getKeys(e,t)))},closesetdialogVisible(){this.defKeys=[]},rolesdialogclose(){this.$refs.addRolesRef.resetFields()},changedialogclose(){this.$refs.changeRolesRef.resetFields()},addrole(){this.$refs.addRolesRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("roles",this.addroles);if(201!==t.meta.status)return this.$message.error("添加用户失败");this.$message.success("添加用户成功"),this.addrolesdialogVisible=!1,this.getrolrlist()}))},async changerolesdialog(e){const{data:t}=await this.$http.get("roles/"+e);if(200!==t.meta.status)return this.$message.error("查询用户失败");this.changeRoles=t.data,this.changerolesdialogVisible=!0},changerole(){this.$refs.changeRolesRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put("roles/"+this.changeRoles.roleId,{roleName:this.changeRoles.roleName,roleDesc:this.changeRoles.roleDesc});if(200!==t.meta.status)return this.$message.error("编辑用户失败");this.changerolesdialogVisible=!1,this.getrolrlist(),this.$message.success("编辑成功")}))},async delroles(e){const t=await this.$confirm("此操作将删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消操作");const{data:a}=await this.$http.delete("roles/"+e);if(200!==a.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getrolrlist()},async allotRights(){const e=[...this.$refs.treeRef.getCheckedKeys(),...this.$refs.treeRef.getHalfCheckedKeys()],t=e.join(","),{data:a}=await this.$http.post(`roles/${this.roleId}/rights`,{rids:t});if(200!==a.meta.status)return this.$message.error("分配失败");this.$message.success("分配成功"),this.getrolrlist(),this.setdialogVisible=!1}}},H=Y,G=(0,n.Z)(H,M,A,!1,null,"454d19f0",null),J=G.exports,Q=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("数据统计")]),t("el-breadcrumb-item",[e._v("数据报表")])],1),t("el-card",[t("div",{staticStyle:{width:"100%",height:"600px"},attrs:{id:"main"}})])],1)},W=[],X=a(8194),ee=a(4806),te=a.n(ee),ae={data(){return{options:{title:{text:"用户来源"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#E9EEF3"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{boundaryGap:!1}],yAxis:[{type:"value"}]}}},created(){},async mounted(){var e=X.S1(document.getElementById("main"));const{data:t}=await this.$http.get("reports/type/1");if(200!==t.meta.status)return this.$message.error("获取数据失败");const a=te().merge(t.data,this.options);e.setOption(a)},methods:{}},se=ae,re=(0,n.Z)(se,Q,W,!1,null,"5b531786",null),ie=re.exports,oe=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("参数列表")])],1),t("el-card",[t("el-alert",{attrs:{title:"只允许为第三级分类设置参数",type:"warning","show-icon":"",closable:!1}}),t("el-row",{staticClass:"cat_opt"},[t("el-col",[t("span",[e._v("选择商品分类：")]),t("el-cascader",{attrs:{"expand-trigger":"hover",options:e.catelist,props:e.cateProps},on:{change:e.handleChange},model:{value:e.selectedcatekeys,callback:function(t){e.selectedcatekeys=t},expression:"selectedcatekeys"}})],1)],1),t("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[t("el-button",{attrs:{size:"mini",type:"primary",disabled:e.isbtndis},on:{click:function(t){e.adialogVisible=!0}}},[e._v("添加参数")]),t("el-table",{attrs:{data:e.manydata,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._l(a.row.attr_vals,(function(s,r){return t("el-tag",{key:r,attrs:{closable:""},on:{close:function(t){return e.closetag(r,a.row)}}},[e._v(" "+e._s(s)+" ")])})),a.row.inputVisible?t("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(t){return e.handleInputConfirm(a.row)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(a.row)}},model:{value:a.row.inputValue,callback:function(t){e.$set(a.row,"inputValue",t)},expression:"scope.row.inputValue"}}):t("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(t){return e.showInput(a.row)}}},[e._v("+ New Tag")])]}}])}),t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showdialog(a.row.attr_id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.delbtn(a.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1),t("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[t("el-button",{attrs:{size:"mini",type:"primary",disabled:e.isbtndis},on:{click:function(t){e.adialogVisible=!0}}},[e._v("添加属性")]),t("el-table",{attrs:{data:e.onlydata,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._l(a.row.attr_vals,(function(s,r){return t("el-tag",{key:r,attrs:{closable:""},on:{close:function(t){return e.closetag(r,a.row)}}},[e._v(" "+e._s(s)+" ")])})),a.row.inputVisible?t("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(t){return e.handleInputConfirm(a.row)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(a.row)}},model:{value:a.row.inputValue,callback:function(t){e.$set(a.row,"inputValue",t)},expression:"scope.row.inputValue"}}):t("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(t){return e.showInput(a.row)}}},[e._v("+ New Tag")])]}}])}),t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showdialog(a.row.attr_id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.delbtn(a.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),t("el-dialog",{attrs:{title:"添加"+e.title,visible:e.adialogVisible,width:"50%"},on:{"update:visible":function(t){e.adialogVisible=t},close:e.closeaddForm}},[t("el-form",{ref:"addFormref",attrs:{model:e.addForm,rules:e.addFormrules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:e.title,prop:"attr_name"}},[t("el-input",{model:{value:e.addForm.attr_name,callback:function(t){e.$set(e.addForm,"attr_name",t)},expression:"addForm.attr_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.adialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addparmas}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"修改"+e.title,visible:e.editdialogVisible,width:"50%"},on:{"update:visible":function(t){e.editdialogVisible=t},close:e.closeeditForm}},[t("el-form",{ref:"editFormref",attrs:{model:e.editForm,rules:e.editFormrules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:e.title,prop:"attr_name"}},[t("el-input",{model:{value:e.editForm.attr_name,callback:function(t){e.$set(e.editForm,"attr_name",t)},expression:"editForm.attr_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editparmas}},[e._v("确 定")])],1)],1)],1)},le=[],ne={data(){return{manydata:[],onlydata:[],catelist:[],inputValue:"",editForm:{},addForm:{attr_name:""},adialogVisible:!1,inputVisible:!1,cateProps:{value:"cat_id",label:"cat_name",children:"children"},selectedcatekeys:[],activeName:"many",addFormrules:{attr_name:[{required:!0,message:"请输入内容",trigger:"blur"}]},editdialogVisible:!1,editFormrules:{attr_name:[{required:!0,message:"请输入内容",trigger:"blur"}]}}},created(){this.getCateList()},methods:{async getCateList(){const{data:e}=await this.$http.get("categories");if(200!==e.meta.status)return this.$message.error("获取数据失败");this.catelist=e.data},handleChange(){this.getparamsdata()},handleClick(){this.getparamsdata()},async getparamsdata(){if(3!==this.selectedcatekeys.length)return this.selectedcatekeys=[],this.manydata=[],void(this.only=[]);const{data:e}=await this.$http.get(`categories/${this.cateid}/attributes`,{params:{sel:this.activeName}});if(200!==e.meta.status)return this.$message.error("获取数据失败");e.data.forEach((e=>{e.attr_vals=e.attr_vals?e.attr_vals.split(" "):[],e.inputVisible=!1,e.inputValue=""})),"many"===this.activeName?this.manydata=e.data:this.onlydata=e.data},closeaddForm(){this.$refs.addFormref.resetFields()},closeeditForm(){this.$refs.editFormref.resetFields()},addparmas(){this.$refs.addFormref.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post(`categories/${this.cateid}/attributes`,{attr_name:this.addForm.attr_name,attr_sel:this.activeName});if(201!==t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.adialogVisible=!1,this.getparamsdata()}))},async showdialog(e){const{data:t}=await this.$http.get(`categories/${this.cateid}/attributes/${e}`,{params:{attr_sel:this.activeName}});if(200!==t.meta.status)return this.$message.error("获取数据失败");this.editForm=t.data,this.editdialogVisible=!0},editparmas(){this.$refs.editFormref.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put(`categories/${this.cateid}/attributes/${this.editForm.attr_id}`,{attr_name:this.editForm.attr_name,attr_sel:this.activeName});if(200!==t.meta.status)return this.$message.error("修改失败");this.$message.success("修改成功"),this.getparamsdata(),this.editdialogVisible=!1}))},async delbtn(e){const t=await this.$confirm("此操作将删除该参数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消操作");const{data:a}=await this.$http.delete(`categories/${this.cateid}/attributes/${e}`);if(200!==a.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getparamsdata()},async handleInputConfirm(e){if(0===e.inputValue.trim().length)return e.inputValue="",void(e.inputVisible=!1);e.attr_vals.push(e.inputValue.trim()),e.inputValue="",e.inputVisible=!1,this.savetag(e)},showInput(e){e.inputVisible=!0,this.$nextTick((e=>{this.$refs.saveTagInput.$refs.input.focus()}))},async savetag(e){const{data:t}=await this.$http.put(`categories/${this.cateid}/attributes/${e.attr_id}`,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")});if(200!==t.meta.status)return this.$message.error("修改失败");this.$message.success("修改成功")},closetag(e,t){t.attr_vals.splice(e,1),this.savetag(t)}},computed:{isbtndis(){return 3!==this.selectedcatekeys.length},cateid(){return 3===this.selectedcatekeys.length?this.selectedcatekeys[2]:null},title(){return"many"===this.activeName?"动态参数":"静态属性"}}},ce=ne,de=(0,n.Z)(ce,oe,le,!1,null,"a3f0a4ce",null),ue=de.exports,me=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("订单管理")]),t("el-breadcrumb-item",[e._v("订单列表")])],1),t("el-card",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-input",{attrs:{placeholder:"请输入内容",clearable:""}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)],1),t("el-table",{attrs:{data:e.orderlist,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"订单编号",prop:"order_number"}}),t("el-table-column",{attrs:{label:"订单价格",prop:"order_price",width:"95px"}}),t("el-table-column",{attrs:{label:"付款状态",prop:"pay_status",width:"95px"},scopedSlots:e._u([{key:"default",fn:function(a){return["1"===a.row.pay_status?t("el-tag",{attrs:{type:"success"}},[e._v("已付款")]):t("el-tag",{attrs:{type:"danger"}},[e._v("未付款")])]}}])}),t("el-table-column",{attrs:{label:"是否发货",prop:"is_send",width:"95px"}}),t("el-table-column",{attrs:{label:"购买时间",prop:"create_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.create_time))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作"}},[[t("el-button",{attrs:{type:"success",icon:"el-icon-location-outline",circle:""},on:{click:e.showbox}})]],2)],1),t("el-pagination",{attrs:{"current-page":e.queryinfo.pagenum,"page-sizes":[10,20,30],"page-size":e.queryinfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"物流进度",visible:e.prodialogVisible,width:"50%"},on:{"update:visible":function(t){e.prodialogVisible=t}}},[t("el-form",{ref:"addressFormRef",attrs:{model:e.addressForm,rules:e.addressFormrules,"label-width":"100px"}},[t("el-timeline",e._l(e.proinfo,(function(a,s){return t("el-timeline-item",{key:s,attrs:{timestamp:a.time}},[e._v(" "+e._s(a.context)+" ")])})),1)],1)],1)],1)},pe=[],ge={data(){return{queryinfo:{query:"",pagenum:1,pagesize:10},proinfo:[],orderlist:[],total:0,prodialogVisible:!1}},created(){this.getorderlist()},methods:{async getorderlist(){const{data:e}=await this.$http.get("orders",{params:this.queryinfo});if(200!==e.meta.status)return this.$message.error("获取数据失败");this.orderlist=e.data.goods,this.total=e.data.total},handleSizeChange(e){this.queryinfo.pagesize=e,this.getorderlist()},handleCurrentChange(e){this.queryinfo.pagenum=e,this.getorderlist()},async showbox(){const{data:e}=await this.$http.get("/kuaidi/1106975712662");if(200!==e.meta.status)return this.$message.error("获取数据失败");this.proinfo=e.data,this.prodialogVisible=!0}}},he=ge,fe=(0,n.Z)(he,me,pe,!1,null,"362b38aa",null),be=fe.exports,ve=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("商品列表")])],1),t("el-card",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getgoodslist},model:{value:e.queryinfo.query,callback:function(t){e.$set(e.queryinfo,"query",t)},expression:"queryinfo.query"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getgoodslist},slot:"append"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:e.addgoods}},[e._v("添加商品")])],1)],1),t("el-table",{attrs:{border:"",stripe:"",data:e.goodslist}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{label:"商品名称",prop:"goods_name"}}),t("el-table-column",{attrs:{label:"商品价格(元)",prop:"goods_price",width:"85px"}}),t("el-table-column",{attrs:{label:"商品重量",prop:"goods_weight",width:"70px"}}),t("el-table-column",{attrs:{label:"创建时间",prop:"add_time",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.add_time))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"230px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.delgoods(a.row.goods_id)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.queryinfo.pagenum,"page-sizes":[10,20,30],"page-size":e.queryinfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},_e=[],ye={data(){return{queryinfo:{query:"",pagenum:1,pagesize:10},goodslist:[],total:0}},created(){this.getgoodslist()},methods:{async getgoodslist(){const{data:e}=await this.$http.get("goods",{params:this.queryinfo});if(200!==e.meta.status)return this.$message.error("获取数据失败");this.goodslist=e.data.goods,this.total=e.data.total},handleSizeChange(e){this.queryinfo.pagesize=e,this.getgoodslist()},handleCurrentChange(e){this.queryinfo.pagenum=e,this.getgoodslist()},async delgoods(e){const t=await this.$confirm("此操作将删除该商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消操作");const{data:a}=await this.$http.delete(`goods/${e}`);if(200!==a.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getgoodslist()},addgoods(){this.$router.push("/goods/add")}}},we=ye,$e=(0,n.Z)(we,ve,_e,!1,null,"aeb7d352",null),ke=$e.exports,xe=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("商品分类")])],1),t("el-card",[t("el-row",[t("el-col",[t("el-button",{attrs:{type:"primary"},on:{click:e.showadddialogVisible}},[e._v("添加分类")])],1)],1),t("tree-table",{attrs:{data:e.catalist,columns:e.columns,"selection-type":!1,"expand-type":!1,"show-index":"","index-text":"",border:"","show-row-hover":!1},scopedSlots:e._u([{key:"isok",fn:function(e){return[!1===e.row.cat_deleted?t("i",{staticClass:"el-icon-success",staticStyle:{color:"lightgreen"}}):t("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})]}},{key:"order",fn:function(a){return[0===a.row.cat_level?t("el-tag",{attrs:{size:"mini"}},[e._v("一级")]):1===a.row.cat_level?t("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("二级")]):t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v("三级")])]}},{key:"opt",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showsetdialog(a.row.cat_id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.deletecate(a.row.cat_id)}}},[e._v("删除")])]}}])}),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[3,5,10],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"添加分类",visible:e.adddialogVisible,width:"50%"},on:{"update:visible":function(t){e.adddialogVisible=t},close:e.closeadddialogVisible}},[t("el-form",{ref:"addcateformRef",attrs:{model:e.addcateform,rules:e.addcateformRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称:",prop:"cat_name"}},[t("el-input",{model:{value:e.addcateform.cat_name,callback:function(t){e.$set(e.addcateform,"cat_name",t)},expression:"addcateform.cat_name"}})],1),t("el-form-item",{attrs:{label:"父级分类:"}},[t("el-cascader",{attrs:{"expand-trigger":"hover",options:e.parentcatelist,props:e.cateprops,clearable:"","change-on-select":""},on:{change:e.catechange},model:{value:e.selectkeys,callback:function(t){e.selectkeys=t},expression:"selectkeys"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.adddialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addcate}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"编辑",visible:e.setdialogVisible,width:"50%"},on:{"update:visible":function(t){e.setdialogVisible=t},close:e.closesetdialogVisible}},[t("el-form",{ref:"setcateformRef",attrs:{model:e.setcateform,rules:e.setcateformRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称:",prop:"cat_name"}},[t("el-input",{model:{value:e.setcateform.cat_name,callback:function(t){e.$set(e.setcateform,"cat_name",t)},expression:"setcateform.cat_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.setdialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.setcate}},[e._v("确 定")])],1)],1)],1)},Fe=[],Ve={data(){return{setdialogVisible:!1,adddialogVisible:!1,queryInfo:{type:3,pagenum:1,pagesize:5},catalist:[],total:0,columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",type:"template",template:"isok"},{label:"排序",type:"template",template:"order"},{label:"操作",type:"template",template:"opt"}],addcateform:{cat_name:"",cat_pid:0,cat_level:0},addcateformRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},setcateformRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},parentcatelist:[],cateprops:{value:"cat_id",label:"cat_name",children:"children"},setcateform:{},selectkeys:[]}},created(){this.getcatelist()},methods:{async getcatelist(){const{data:e}=await this.$http.get("categories",{params:this.queryInfo});if(200!==e.meta.status)return this.$message.error("获取失败");this.catalist=e.data.result,this.total=e.data.total},handleSizeChange(e){this.queryInfo.pagesize=e,this.getcatelist()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getcatelist()},showadddialogVisible(){this.getparentcatelist(),this.adddialogVisible=!0},async getparentcatelist(){const{data:e}=await this.$http.get("categories",{params:{type:2}});if(200!==e.meta.status)return this.$message.error("获取失败");this.parentcatelist=e.data},catechange(){if(this.selectkeys.length>0)return this.addcateform.cat_pid=this.selectkeys[this.selectkeys.length-1],void(this.addcateform.cat_level=this.selectkeys.length);this.addcateform.cat_pid=0,this.addcateform.cat_level=0},closeadddialogVisible(){this.$refs.addcateformRef.resetFields(),this.selectkeys=[],this.addcateform.cat_pid=0,this.addcateform.cat_level=0},closesetdialogVisible(){this.$refs.setcateformRef.resetFields()},addcate(){this.$refs.addcateformRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("categories",this.addcateform);if(201!==t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.getcatelist(),this.adddialogVisible=!1}))},async showsetdialog(e){const{data:t}=await this.$http.get("categories/"+e);if(200!==t.meta.status)return this.$message.error("查询用户失败");this.setcateform=t.data,this.setdialogVisible=!0},setcate(){this.$refs.setcateformRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put("categories/"+this.setcateform.cat_id,{cat_name:this.setcateform.cat_name});if(200!==t.meta.status)return this.$message.error("编辑用户失败");this.setdialogVisible=!1,this.getcatelist(),this.$message.success("编辑成功")}))},async deletecate(e){const t=await this.$confirm("此操作将删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消操作");const{data:a}=await this.$http.delete("categories/"+e);if(200!==a.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getcatelist()}}},Ce=Ve,ze=(0,n.Z)(Ce,xe,Fe,!1,null,"3fdd2a18",null),qe=ze.exports,Re=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("商品列表")]),t("el-breadcrumb-item",[e._v("添加商品")])],1),t("el-card",[t("el-alert",{attrs:{title:"添加商品信息",type:"info",center:"","show-icon":"",closable:!1}}),t("el-steps",{attrs:{space:200,active:e.activeindex-0,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"基本信息"}}),t("el-step",{attrs:{title:"商品参数"}}),t("el-step",{attrs:{title:"商品属性"}}),t("el-step",{attrs:{title:"商品图片"}}),t("el-step",{attrs:{title:"商品内容"}}),t("el-step",{attrs:{title:"完成"}})],1),t("el-form",{ref:"addFormref",attrs:{model:e.addForm,rules:e.addFormrules,"label-width":"100px","label-position":"top"}},[t("el-tabs",{attrs:{"tab-position":"left","before-leave":e.bfleave},on:{"tab-click":e.tabclick},model:{value:e.activeindex,callback:function(t){e.activeindex=t},expression:"activeindex"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[t("el-input",{model:{value:e.addForm.goods_name,callback:function(t){e.$set(e.addForm,"goods_name",t)},expression:"addForm.goods_name"}})],1),t("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_price,callback:function(t){e.$set(e.addForm,"goods_price",t)},expression:"addForm.goods_price"}})],1),t("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_weight,callback:function(t){e.$set(e.addForm,"goods_weight",t)},expression:"addForm.goods_weight"}})],1),t("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[t("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_number,callback:function(t){e.$set(e.addForm,"goods_number",t)},expression:"addForm.goods_number"}})],1),t("el-form-item",{attrs:{label:"商品分类",prop:"goods_cat"}},[t("el-cascader",{attrs:{"expand-trigger":"hover",options:e.catelist,props:e.cateprops},on:{change:e.handleChange},model:{value:e.addForm.goods_cat,callback:function(t){e.$set(e.addForm,"goods_cat",t)},expression:"addForm.goods_cat"}})],1)],1),t("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manydata,(function(a){return t("el-form-item",{key:a.attr_id,attrs:{label:a.attr_name}},[t("el-checkbox-group",{model:{value:a.attr_vals,callback:function(t){e.$set(a,"attr_vals",t)},expression:"item.attr_vals"}},e._l(a.attr_vals,(function(e,a){return t("el-checkbox",{key:a,attrs:{label:e,border:""}})})),1)],1)})),1),t("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlydata,(function(a){return t("el-form-item",{key:a.attr_id,attrs:{label:a.attr_name}},[t("el-input",{model:{value:a.attr_vals,callback:function(t){e.$set(a,"attr_vals",t)},expression:"item.attr_vals"}})],1)})),1),t("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[t("el-upload",{attrs:{action:"https://lianghj.top:8888/api/private/v1/upload","on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture",headers:e.headerObj,"on-success":e.picsuccess}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),t("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[e._v("商品内容 "),t("quill-editor",{model:{value:e.addForm.goods_introduce,callback:function(t){e.$set(e.addForm,"goods_introduce",t)},expression:"addForm.goods_introduce"}}),t("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加商品")])],1)],1)],1)],1),t("el-dialog",{attrs:{title:"图片预览",visible:e.picdialogVisible,width:"50%"},on:{"update:visible":function(t){e.picdialogVisible=t}}},[t("img",{staticClass:"pic",attrs:{src:e.Previewpath,alt:""}})])],1)},Se=[],Ie={data(){return{activeindex:"0",addForm:{goods_name:"",goods_price:0,goods_weight:0,goods_number:0,goods_cat:[],pics:[],goods_introduce:"",attrs:[]},catelist:[],cateprops:{label:"cat_name",value:"cat_id",children:"children"},manydata:[],onlydata:[],Previewpath:"",picdialogVisible:!1,headerObj:{Authorization:window.sessionStorage.getItem("token")},addFormrules:{goods_name:[{required:!0,message:"请输入商品名",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_cat:[{required:!0,message:"请选择商品分类",trigger:"blur"}]}}},created(){this.getcatelist()},methods:{async getcatelist(){const{data:e}=await this.$http.get("categories");if(200!==e.meta.status)return this.$message.error("获取失败");this.catelist=e.data},handleChange(){3!==this.addForm.goods_cat.length&&(this.addForm.goods_cat=[])},bfleave(e,t){if("0"===t&&3!==this.addForm.goods_cat.length)return this.$message.error("请先选择分类"),!1},async tabclick(){if("1"===this.activeindex){const{data:e}=await this.$http.get(`categories/${this.cateid}/attributes`,{params:{sel:"many"}});if(200!==e.meta.status)return this.$message.error("获取数据失败");e.data.forEach((e=>{e.attr_vals=0===e.attr_vals.length?[]:e.attr_vals.split(" ")})),this.manydata=e.data}else if("2"===this.activeindex){const{data:e}=await this.$http.get(`categories/${this.cateid}/attributes`,{params:{sel:"only"}});if(200!==e.meta.status)return this.$message.error("获取数据失败");this.onlydata=e.data}},handlePreview(e){this.picdialogVisible=!0,this.Previewpath=e.response.data.url},handleRemove(e){const t=e.response.data.tmp_path,a=this.addForm.pics.findIndex((e=>e.pic===t));this.addForm.pics.splice(a,1)},picsuccess(e){const t={pic:e.data.tmp_path};this.addForm.pics.push(t)},add(){this.$refs.addFormref.validate((async e=>{if(!e)return this.$message.error("请填写必填项");const t=te().cloneDeep(this.addForm);t.goods_cat=t.goods_cat.join(","),this.manydata.forEach((e=>{const t={attr_id:e.attr_id,attr_value:e.attr_vals.join(" ")};this.addForm.attrs.push(t)})),this.onlydata.forEach((e=>{const t={attr_id:e.attr_id,attr_value:e.attr_vals};this.addForm.attrs.push(t)})),t.attrs=this.addForm.attrs;const{data:a}=await this.$http.post("goods",t);if(201!==a.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.$router.push("/goods")}))}},computed:{cateid(){return 3===this.addForm.goods_cat.length?this.addForm.goods_cat[2]:null}}},Ne=Ie,je=(0,n.Z)(Ne,Re,Se,!1,null,"070b62dc",null),Te=je.exports;s["default"].use(u.ZP);const De=new u.ZP({routes:[{path:"/",redirect:"/login"},{path:"/login",component:b},{path:"/home",component:k,redirect:"/welcome",children:[{path:"/welcome",component:I},{path:"/users",component:O},{path:"/rights",component:K},{path:"/roles",component:J},{path:"/reports",component:ie},{path:"/params",component:ue},{path:"/orders",component:be},{path:"/goods",component:ke},{path:"/goods/add",component:Te},{path:"/categories",component:qe}]}]});De.beforeEach(((e,t,a)=>{if("/login"===e.path)return a();const s=window.sessionStorage.getItem("token");if(!s)return a("/login");a()}));var Pe=De,Oe=a(7881),Le=a.n(Oe),Ze=a(7934),Be=a.n(Ze),Ee=a(7142),Ue=a.n(Ee),Ke=a(6445),Me=a.n(Ke),Ae=a(3755),Ye=a.n(Ae),He=a(5464),Ge=a.n(He),Je=a(82),Qe=a.n(Je),We=a(2329),Xe=a.n(We),et=a(8787),tt=a.n(et),at=a(7199),st=a.n(at),rt=a(4359),it=a.n(rt),ot=a(6971),lt=a.n(ot),nt=a(2804),ct=a.n(nt),dt=a(9363),ut=a.n(dt),mt=a(860),pt=a.n(mt),gt=a(7342),ht=a.n(gt),ft=a(2572),bt=a.n(ft),vt=a(152),_t=a.n(vt),yt=a(3256),wt=a.n(yt),$t=a(2244),kt=a.n($t),xt=a(6830),Ft=a.n(xt),Vt=a(488),Ct=a.n(Vt),zt=a(8037),qt=a.n(zt),Rt=a(3480),St=a.n(Rt),It=a(2086),Nt=a.n(It),jt=a(5583),Tt=a.n(jt),Dt=a(9371),Pt=a.n(Dt),Ot=a(4514),Lt=a.n(Ot),Zt=a(107),Bt=a.n(Zt),Et=a(4889),Ut=a.n(Et),Kt=a(138),Mt=a.n(Kt),At=a(6734),Yt=a.n(At),Ht=a(7796),Gt=a.n(Ht),Jt=a(2969),Qt=a.n(Jt),Wt=a(5436),Xt=a.n(Wt),ea=a(923),ta=a.n(ea),aa=a(1393),sa=a.n(aa),ra=a(8172),ia=a.n(ra),oa=a(3729),la=a.n(oa),na=a(1407),ca=a.n(na),da=a(5981),ua=a.n(da),ma=a(1168),pa=a.n(ma),ga=a(8319),ha=a.n(ga),fa=a(1540),ba=a.n(fa);s["default"].use(ba()),s["default"].use(ha()),s["default"].use(pa()),s["default"].use(ua()),s["default"].use(ca()),s["default"].use(la()),s["default"].use(ia()),s["default"].use(sa()),s["default"].use(ta()),s["default"].use(Xt()),s["default"].use(Qt()),s["default"].use(Gt()),s["default"].use(Yt()),s["default"].use(Mt()),s["default"].use(Ut()),s["default"].use(Bt()),s["default"].use(Lt()),s["default"].use(Pt()),s["default"].use(Tt()),s["default"].use(Nt()),s["default"].use(St()),s["default"].use(qt()),s["default"].use(Ct()),s["default"].use(Ft()),s["default"].use(kt()),s["default"].use(wt()),s["default"].use(_t()),s["default"].use(bt()),s["default"].use(ht()),s["default"].use(pt()),s["default"].use(ut()),s["default"].use(ct()),s["default"].use(lt()),s["default"].use(it()),s["default"].use(st()),s["default"].use(tt()),s["default"].use(Xe()),s["default"].use(Qe()),s["default"].use(Ge()),s["default"].use(Ye()),s["default"].use(Me()),s["default"].use(Ue()),s["default"].prototype.$message=Be(),s["default"].prototype.$confirm=Le().confirm;var va=a(6790),_a=a.n(va),ya=a(7715),wa=a.n(ya),$a=a(70);$a.ZP.defaults.baseURL="https://lianghj.top:8888/api/private/v1/",$a.ZP.interceptors.request.use((e=>(e.headers.Authorization=window.sessionStorage.getItem("token"),e))),s["default"].use(wa()),s["default"].prototype.$http=$a.ZP,s["default"].config.productionTip=!1,s["default"].component("tree-table",_a()),s["default"].filter("dateFormat",(function(e){const t=new Date(e),a=t.getFullYear(),s=(t.getMonth()+1+"").padStart(2,"0"),r=(t.getDate()+"").padStart(2,"0"),i=(t.getHours()+"").padStart(2,"0"),o=(t.getMinutes()+"").padStart(2,"0"),l=(t.getSeconds()+"").padStart(2,"0");return`${a}-${s}-${r} ${i}:${o}:${l}`})),new s["default"]({router:Pe,render:e=>e(d)}).$mount("#app")}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,function(){var e=[];a.O=function(t,s,r,i){if(!s){var o=1/0;for(d=0;d<e.length;d++){s=e[d][0],r=e[d][1],i=e[d][2];for(var l=!0,n=0;n<s.length;n++)(!1&i||o>=i)&&Object.keys(a.O).every((function(e){return a.O[e](s[n])}))?s.splice(n--,1):(l=!1,i<o&&(o=i));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,r,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,i,o=s[0],l=s[1],n=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(n)var d=n(a)}for(t&&t(s);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(d)},s=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(4043)}));s=a.O(s)})();
//# sourceMappingURL=app.6cfc03ee.js.map